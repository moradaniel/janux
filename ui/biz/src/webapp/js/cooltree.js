// Title: COOLjsTree
// URL: http://javascript.cooldev.com/scripts/cooltree/
// Version: 2.7.0
// Last Modify: 23 Jul 2005
// Author: Alex Kunin <alx@cooldev.com>
// Notes: Registration needed to use this script on your web site.
// Copyright (c) 2001-2005 by CoolDev.Com
// Copyright (c) 2001-2005 by Sergey Nosenko

// Options: STANDARD, COMPRESSED, WATERMARK

function _c(_7){return typeof(_7)=='undefined'};function _2I(_7){return typeof(_7)=='number'};function _2J(_7){return typeof(_7)=='object'};function COOLjsTree(_b,_e,_4){this.name=this._b=_b;this.bw=new _1r();var _a={};_a._Q=_4[0];_a._N=_4[1];_a._R={nb:_4[2],nf:_4[5]};_a._2g=_4[3][0];_a._2j=_4[3][1];_a.iE=_4[3][2];_a._1e=_4[4][0];_a._1f=_4[4][1];_a.Ew=_4[4][2];_a.clF=_4[6][0];_a.exF=_4[6][1];_a.iF=_4[6][2];_a._1a=_4[7][0];_a._16=_4[7][1];_a.ident=_4[8];_a._1k=_4[10];_a._2i=_4[11];_a.so=_4[12];_a.pg=_4[13][0];_a.sp=_4[13][1];if(_a._R.nb)_1x(_4[3]);if(_a._R.nf)_1x(_4[6]);this._4=_a;if(!this.bw._G)this._B=new _1u(_4[9],this);if(_c(window.CTrees))window.CTrees=[];window.CTrees[_b]=this;this.jsPath="window.CTrees['"+_b+"']";this.Nodes=this._e=[];this._2k=-1;this._2b=0;this._1i={};this._n=this._13(([{id:null},'',null,null,{format:{}}]).concat(_e));this._K=this.bw._J?'':'px';this._u=this.bw.dom&&!this.bw._J;this._1s=document.body&&document.body.dir=='rtl';this._E=-1;this.init();this._29=true;this.draw()};$=COOLjsTree.prototype;$._12={};$.$handleEvent=function(_o,_1j){var _1=this._2z(_1j);if(_1&&!_c(_1._1A()[_o]))_1._1A()[_o](_1);return this[_o](_1)};$._o=function(_2n,_m,_1j){return _$('on'+_2n,'return '+this.jsPath+'.$handleEvent(\'' + _m + '_' + 'on' + _2n + '\', '+_1j+')')};$._1y=function(_m,_1){if(_c(this._12[_m])){this._12[_m]={};for(var _o in this)if(_o.match(new RegExp('^'+_m+'_'+'on(.+)$')))this._12[_m][RegExp.$1]=true};var _9='';for(var _o in this._12[_m])_9+=this._o(_o,_m,_1._5);return _9};$.getAdditionalColumns=function(_1){return''};$.getRoot=$._1m=function(){if(!this._C){this._n._g=this._C=new _1b(this._n,this,null,false);this._C._M(true)};return this._C};$._1z=function(_5){var _k=this._18('n',_5,this._n._3);if(!_k)return null;var _8=this._n,i=0;for(var i=0;i<_k.length-1;i++)_8=_8._3[_k[i]];return[_8,_k[i]]};$._11=function(_1){if(this._C&&_1._5==this._C._5)this._C=null;if(_1._g){_1._g._1g();_1._s=null;_1._g=null};for(var i in _1._3)if(_1._3[i]._g)this._11(_1._3[i])};$._2T=function(_1E,_q,_6){var _8;if(_1E==this._n._5)_8=this._n;else{var _w=this._1z(_1E);if(_w)_8=_w[0]._3[_w[1]]};if(_8){this._11(_8);for(var i in _6)_6[i]=this._13(_6[i]);_q=Math.max(0,Math.min(_q,_8._3.length));if(_q==_8._3.length){_8._3=_8._3.concat(_6)}else{var _3=_8._3;_8._3=[];for(var i in _3){if(i==_q)_8._3=_8._3.concat(_6);_8._3[_8._3.length]=_3[i]}};return _q}else return null};$._2o=function(_5,_6,_2u,_2v,_2t){var _w=this._1z(_5);if(_w){var _8=_w[0],_3=_8._3,_5=_w[1];this._11(_8);var _6=this._13(_6);if(_2u)_6[0]=_8._3[_5][0];if(_2v)_6[4]=_8._3[_5][4];if(_2t)_6._3=_8._3[_5]._3;_8._3[_5]=_6}};$._2K=function(_8,_5){if(!_c(_8._3[_5])){var _3=_8._3;this._11(_8);_8._3=[];for(var i in _3)if(i!=_5)_8._3[_8._3.length]=_3[i]}};$.getSelectedNode=function(){return this.nodeByIndex(this._1w)};$._2y=function(_1){return this._1w===_1._5};$._1p=function(_O){for(var i in _O){this._15[_O[i].id]=_O[i];if(_O[i].layers)this._1p(_O[i].layers)}};$._1G=function(_h){if(this.bw.ns4){if(!this._15){this._15={};this._1p(document.layers)};return this._15[_h]}else return(document.all&&document.all[_h])||document.getElementById(_h)};$.moveTo=function(x,y){this._B._N=y;this._B._Q=x;this._B.moveTo(x,y);this._4._N=y;this._4._Q=x;this.draw()};$.ensureVisible=function(_5,_2G){var _1=this.nodeByIndex(_5);var _v=false;while(_1){_1=_1._s;if(_1._V())break;if(!_1._i()){this.expandNode(_1._5,1);_v=true}};if(_v&&!_2G)this.draw()};$._18=function(_T,_7,_e){for(var i in _e){switch(typeof(_7)){case'string':case'number':if(_e[i][_T]==_7)return[i];break;default:if((''+_e[i][_T]).match(_7))return[i]};var _1o=this._18(_T,_7,_e[i]._3);if(_1o)return[i].concat(_1o)};return null};$._W=function(_T,_7){return this._1m()._1R(this._18(_T,_7,this._n._3))};$.nbn=$.nodeByName=function(_7){return this._W('c',_7)};$.nodeByID=function(_7){return this._W('i',_7)};$.nodeByURL=function(_7){return this._W('u',_7)};$.nodeByIndex=$._2z=function(_7){if(!this._e[_7])this._e[_7]=this._W('n',_7);return this._e[_7]};$.nodeByXY=function(_X,_Y){for(var i in this._e)if(this._e[i])with(this._e[i])if(visible&&_p<=_X&&_f<=_Y&&_p+w>_X&&_f+h>_Y)return this._e[i];return null};$._v=function(_f){if(!this._1Z)this._1Z=window.setTimeout(this.jsPath+'.draw()',1);if(typeof(_f)=='number')this._E=Math.min(_f,this._E);else this._E=-1};$._1g=function(_1){_1._1g()};$._D=function(){if(this._u)for(var _5 in this._1i){var _1=this.nodeByIndex(_5);if(_1)_1._D()};this._1i={}};$.draw=function(){if(this.bw._G||!this._29)return;this._D();this._21=true;this._y=0;this._t=0;with(this._1m()){draw(true);if(this._1s)draw(true)};this._B._2r(this._t,this._y);this._1Z=null;this._E=10000000;if(this.ondraw)this.ondraw(this);this._21=false};$.expandNode=function(_5,_2M,_1M){if(!this.bw._G){var _1=this.nodeByIndex(_5);if(_1M)this.selectNode(_5);if(_1&&_1._U()){var _2w=!_1._i();if(this._4.so){this.collapseAll();this.ensureVisible(_1.index,true)};_1._M(_2w);this._v(_1._f)}}};$._1M=$.selectNode=function(_5){this._1w=_5;this._v()};$._1N=function(_l,_1){for(var i in _1._3){this._1N(_l,_1._3[i]);if(_1._3[i]._3.length)if(_1._3[i]._g)_1._3[i]._g._M(_l);else _1._3[i][4].format.expanded=_l}};$._1O=function(_l,_1){this._1N(_l,_1||this._n);this._v()};$.collapseAll=function(_1){this._1O(false,_1&&_1._6)};$.expandAll=function(_1){this._1O(true,_1&&_1._6)};$._13=function(_1){if(_c(_1[_1.length-1]))_1=_1.slice(0,_1.length-1);if(_c(_1[0].id))_1=([{id:null}]).concat(_1);if(_c(_1[4])||_c(_1[4].format))_1=_1.slice(0,4).concat([{format:{}}]).concat(_1.slice(4));var _5=this._2k++;var _3=_1.slice(5);_1=_1.slice(0,5);_1._3=[];for(var i in _3)_1._3[i]=this._13(_3[i]);_1[4]=_1Y(_1[4]);_1.i=_1[0].id;_1.c=_1[1];_1.u=_1[2];_1.t=_1[3];_1.f=_1[4].format;_1.n=_1._5=_5;_1._g=null;return _1};$.init=function(){var s=this._1m()._1K(!this._u);if(!this.bw._G)s=this._B._2p(s);if(this.bw.ns4)s='<div id="'+this._b+'dummytreediv" style="position:absolute;"></div>'+s;document.write(s)};$._2U=function(_b){return document.cookie.match(new RegExp('(\\W|^)'+this._b+_b+'=([^;]+)'))?RegExp.$2:null};$._2W=function(_b,_7){document.cookie=this._b+_b+'='+_7+'; path=/'};$._1V=function(_1){var _9='';for(var i in _1._3)if(_1._3[i]._3.length)_9+=(_1._3[i][4].format.expanded?1:0)+this._1V(_1._3[i]);return _9};$._2V=function(){return this._1V(this._n)};$._1W=function(_1,_l,_5){for(var i in _1._3){if(_1._3[i]._3.length){if(_1._3[i]._g)_1._3[i]._g._M(_l.charAt(_5)=='1');else _1._3[i][4].format.expanded=_l.charAt(_5)=='1';_5=this._1W(_1._3[i],_l,_5+1)}};return _5};$._2R=function(_l){this._1W(this._n,_l||'',0)};$.image_onclick=$.caption_onclick=function(_1){this.expandNode(_1.index,1,1);return true};$.button_onclick=function(_1){this.expandNode(_1.index);return true};$.image_onmouseover=$.button_onmouseover=$.caption_onmouseover=function(_1){window.status=_1.text;return true};$.image_onmouseout=$.button_onmouseout=$.caption_onmouseout=function(node){window.status=window.defaultStatus;return true};function _1b(_6,_2,_8,_1U){var _5=_6._5;this._6=_6;this._5=this.index=_5;this.jsPath=_2.jsPath+'.nodeByIndex('+_5+')';this.treeView=this._2=_2;this._s=this.parentNode=_8;this._1U=_1U;this.text=_6[1];this.url=_6[2];this.target=_6[3];this._2P=null;this.nodeID=_6[0].id;this._4=_6[4].format;this._10=null;this._M(this._6[4].format.expanded);this.children=this._3=[];this._x=this.level=_8?_8._x+1:-1;this.visible=false;this._r={};this._1L=false;this._Z={};if(_8)this._2a()};$=_1b.prototype;$._V=function(){return this._2._n._5==this._5};$._i=function(){return this._6[4].format.expanded};$.id=function(){return this._h};$._1h=function(_1S,_F,_1T){this._2._2o(this._5,[_c(_1S)?this._27():_1S,_c(_F)?this._25():_F,_c(_1T)?this._24():_1T],true,true,true);this._2._v()};$.getTree=function(){return this._2};$.getParent=function(){return this._s};$.getId=function(){return this._6[0].id};$._27=$.getCaption=function(){return this._6[1]};$._25=$.getUrl=function(){return this._6[2]};$._24=$.getTarget=function(){return this._6[3]};$._1A=$.getFormat=function(){return this._6[4].format};$.setCaption=function(_7){this._1h(_7,this._L,this._L)};$.setUrl=function(_7){this._1h(this._L,_7,this._L)};$.setTarget=function(_7){this._1h(this._L,this._L,_7)};$.hasChildren=$._U=function(){return!!this._6._3.length};$._2Q=function(){return this._s&&this._2c()==0};$._1Q=function(){return this._U()||this._6[4].format.isFolder};$._1R=function(_k){if(_k)return _k.length?this._1l(_k[0])._1R(_k.slice(1)):this;return null};$._M=function(_7){this.expanded=this._6[4].format.expanded=!!_7;if(this._H){this._1P('nb',this._1J());this._1P('nf',this._1I())}};$._1J=function(){if(!this._2._4._R.nb||this._4.nobuttons)return null;if(!this._U())return null;if(this._4.buttons)return this._i()?this._4.buttons[1]:this._4.buttons[0];else return this._i()?this._2._4._2j:this._2._4._2g};$._1I=function(){if(!this._2._4._R.nf||this._4.nofolders)return null;if(this._4.folders)return this._1Q()?(this._i()?this._4.folders[1]:this._4.folders[0]):this._4.folders[2];else return this._1Q()?(this._i()?this._2._4.exF:this._2._4.clF):this._2._4.iF};$._1P=function(_d,_19){if(_19){var _17=(this._j().document||document).images[this._h+_d];if(this._2._4._R[_d]&&_17&&_17.src!=_19)this._Z[_d]={_2f:_17,_k:_19}}};$._2a=function(){this._1e=_c(this._4.bsize)?this._2._4._1e:this._4.bsize[0];this._1f=_c(this._4.bsize)?this._2._4._1f:this._4.bsize[1];this._1a=_c(this._4.fsize)?this._2._4._1a:this._4.fsize[0];this._16=_c(this._4.fsize)?this._2._4._16:this._4.fsize[1]};$._1K=function(_14,_2S){var _9='';if(!this._V()){this._h='nt'+this._2._b+'_'+this._2._2b++;_9+=this._2.bw._G?this._1H():'<div'+this._2._1y('layer',this)+' id="'+this._h+'d"  style="'+(this._2.bw.mac||this._2.bw._J?'':'height:1px;width:1px;')+'position:absolute;'+(this._2._u?'':'visibility:hidden;')+'z-index:'+(this.index+10)+';">'+this._1H()+'</div>'};if(_14){if(!this._2._u)_9+='<div id="'+this._h+'ch"  style="left:0;top:0;position:absolute;visibility:hidden;z-index:'+(this.index+10)+';">';_9+=this._22(_14);if(!this._2._u)_9+='</div>'};return _9};$._22=function(_14){var _9='';for(var i=0;i<this._1d();i++)_9+=this._1l(i)._1K(_14);return _9};$._23=function(_F,_m,_2d,_1k,_2m){return'<a'+this._2._1y(_m,this)+' href="'+(_F||'javascript:void(0)')+'"'+_$('target',_F&&this.target)+_$('id',_2m&&(this._h+'an'))+_$('class',_1k)+'>'+_2d+'</a>'};$._1c=function(_m,_d,_1_,_28,_2F,w,h,_2L){if(!w||!_1_)return'';var i='<img'+(_d?' name="'+this._h+_d+'" id="'+this._h+_d+'"':'')+' src="'+_1_+'" width="'+w+'" height="'+h+'" border="0"'+(this._2.bw.ns4?'':' style="display: block"')+' />';return'<td style="font-size:1px;" width="'+w+'">'+(_28?this._23(_2F&&this.url,_m,i):i)+'</td>'};$._2e=function(){with(this._2._4)return _c(ident[this._x])?ident[0]*this._x:ident[this._x]};$._1H=function(){var s='<table cellpadding="'+this._2._4.pg+'" cellspacing="'+this._2._4.sp+'" border="0" class="cls'+this._2._b+'_B'+this._x+'"><tbody><tr>';s+=this._1c('','',this._2._4.iE,false,false,this._2e()+(this._U()?0:this._2._4.Ew),1);s+=this._1c('button','nb',this._1J(),true,false,this._1e,this._1f,'');s+=this._1c('image','nf',this._1I(),true,true,this._1a,this._16,'');s+='<td nowrap="nowrap"><div id="'+this._h+'a" style="position:relative;">'+this._23(this.url,'caption',this.text,this._2E(),true)+'</div></td>';return s+this._2.getAdditionalColumns(this).replace(/\{node\}/g,this.jsPath)+'</tr></tbody></table>'};$._2E=function(){var _9;with(this._2._4)_9=_2i[this._x]||_1k;if(typeof(_9)!='string')_9=_9[this._x];return _9||''};$._2A=function(_p,_f){if(this._p!=_p||this._f!=_f){this._p=_p;this._f=_f;with(this._j())if(this._2.bw.ns4)moveTo(_p,_f);else{style.left=_p+this._2._K;style.top=_f+this._2._K}}};$._1X=function(){if(!this._A)if(this._2._u){var _S=this._A=document.createElement('div');_S.style.position='absolute';_S.style.top=_S.style.left='0px';_S.innerHTML=this._22();this._2._B._j().appendChild(_S)}else this._A=this._j('ch');return this._A};function _20(_P){_P.parentNode.removeChild(_P)};$._1$=function(){if(this._A){var _2C=this._A;this._A=null;for(var i in this._6._3)with(this._6._3[i])if(_g)_g._D();_20(_2C)}};$._2H=function(){if(this._2._u&&!this._H){if(!this._V())this._s._1X();this._H=true;this._r={}}};$._1g=function(){if(this._2._21)this._D();else{this._2._1i[this._5]=true;this._2._v()}};$._D=function(){if(this._H){for(var i in this._r){_20(this._r[i]);this._r[i]=null};this._r={};this.w=this.h=this._p=this._f=0;this._H=false};this._1$();if(!this._V())this._s._1$()};$._1n=function(_P,_7){if(this._2.bw.ns4)_P.visibility=_7?'show':'hide';else _P.style.visibility=_7?'visible':'hidden'};$._1v=function(){if(!this._2._u)this._1n(this._j(),this.visible);if(this.visible){for(var i in this._Z)with(this._Z[i])_2f.src=_k;this._Z={}}};$._1C=function(){this._2A(this._2._1s?(this._2.bw.gecko?this._2._t:0)-this.w:0,this._2.__)};$._1F=function(_2s){if(!this.h||_2s){if(this._2.bw.gecko)with(this._j().childNodes[0]){this.w=offsetWidth;this.h=offsetHeight}else if(this._2.bw.ns4)with(this._j()){this.w=clip.width;this.h=clip.height}else if(this._2.bw.operaNew)with(this._j().childNodes[0]){this.w=offsetWidth;this.h=offsetHeight}else with(this._j()){this.w=offsetWidth||scrollWidth||style.pixelWidth;this.h=offsetHeight||scrollHeight||style.pixelHeight}}};$.draw=function(_z){var _2q=this.visible!=_z;var _2B=this._H;var _2N=this._1L;if(this._V()){this._2.__=0;this.visible=_z}else if(this._f<this._2._E){this._2.__=this._f+this.h;this._2._t=this._t;this._2._y=this._y}else if(this.visible||_z){this._2._E=-1;this.visible=_z;this._1v();if(this.visible){this._1C();this._1F();if(this._1L&&this._10!=this._i()&&_2B){this._D();this.visible=_z;this._1F();this._1C();this._1v()};this._2._t=Math.max(this.w,this._2._t);this._2.__+=this.h;this._2._y=Math.max(this._2.__,this._2._y);this._t=this._2._t;this._y=this._2._y}};if((this.visible&&(this._10||this._i()))||(!this.visible&&_2q&&this._10))this._2D(this._i()&&this.visible);if(this._U()&&this._i()||this._A)this._1n(this._1X(),this._i()&&this.visible);this._10=this._i()};$._2D=function(_z){for(var i=0;i<this._1d();i++)this._1l(i).draw(_z)};$._2O=function(){return this._2._2y(this)};$.getNumberOfChildren=$._1d=function(){return this._6._3.length};$.getChild=$._1l=function(_q){with(this._6._3[_q]){if(!_g){var _1D=this._6._3[_q];_g=this._2._e[_1D._5]=new _1b(_1D,this._2,this,_q<this._1d()-1)};return _g}};$._2c=function(){var _9=0;while(_9<this._s._6._3.length)if(this._s._6._3[_9]._5==this._5)return _9;else _9++;return null};$.getLayer=$._j=function(_d){if(!_d)_d='d';if(!this._r[_d]){this._2H();this._r[_d]=this._2._1G(this._h+_d)};return this._r[_d]};function _1u(_2x,_2){this._2=_2;this._Q=_2._4._Q;this._N=_2._4._N;this._b='cls'+_2._b+'_B';this.color=_2x};$=_1u.prototype;$._j=function(_d){return this._2._1G(this._b+(_d||''))};$._2r=function(_1B,_I){if(this._2.bw._J&&!this._2h){this._2h=true}else{with(this._j('c')){if(this._2.bw.ns4)moveTo(0,_I);else style.top=_I+this._2._K};_I+=7;with(this._j()){if(this._2.bw.ns4)resizeTo(_1B,_I);else{style.width=_1B+this._2._K;style.height=_I+this._2._K}}}};$._2p=function(_2l){var p='relative',l=0,t=0,w=1,h=1;l=this._Q;t=this._N;p='absolute';var _9='<div style="overflow:'+(this._2._J?'scroll':'hidden')+';'+(this.color==""?"":(this._2.bw.ns4?'layer-':'')+'background-color:'+this.color+";")+'position:'+p+';top:'+t+'px;left:'+l+'px;width:'+w+'px;height:'+h+'px;z-index:0;" id="'+this._b+'">'+(this._2.bw.ns4?'<img src="'+this._2._4.iE+'" width="'+w+'" height="'+h+'" />':'')+'<div id="'+this._b+'c" style="position:absolute;font:7px arial,helvetica;color:#d0d0d0;line-height:7px;">'+unescape(('434f4f4c6a7354726565').replace(/(..)/g,'%$1'))+'</div>';return _9+_2l+'</div>'};_$=function(_b,_7){return _7?' '+_b+'="'+_7+'"':''};function _1r(){var _26=parseInt(navigator.appVersion);this.ver=navigator.appVersion;this.agent=navigator.userAgent;this.dom=document.getElementById?1:0;this.opera=window.opera?1:0;this.ie5=this.ver.match(/MSIE 5/)&&this.dom&&!this.opera;this.ie6=this.ver.match(/MSIE 6/)&&this.dom&&!this.opera;this.ie4=document.all&&!this.dom&&!this.opera;this.ie=this.ie4||this.ie5||this.ie6;this.mac=this.agent.match(/Mac/);this.ie3=this.ver.match(/MSIE/)&&_26<4;this.hotjava=this.agent.match(/hotjava/i);this.ns4=document.layers&&!this.dom&&!this.hotjava;this._G=this.hotjava||this.ie3;this.operaNew=this.agent.match(/opera.[789]/i);this.gecko=this.agent.match(/gecko/i);this._J=this.opera&&!this.operaNew};function _1x(_1t){for(var i in _1t)(new Image()).src=_1t[i]};window._1q=window.onload;window.onload=function(){var bw=new _1r();if(typeof(window._1q)=='function')window._1q()};function _1Y(o){var r={};for(var i in o)r[i]=typeof(o[i])=='object'?_1Y(o[i]):o[i];return r}
